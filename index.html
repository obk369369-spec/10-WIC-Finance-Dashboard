<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>WIC 재정·재무 대시보드 v1.2</title>
  <style>
    * { box-sizing: border-box; font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif; }
    body { margin:0; padding:0; background:#f5f5f5; }
    .app { max-width:1200px; margin:0 auto; padding:16px; }
    h1 { font-size:20px; margin-bottom:4px; }
    .sub { font-size:12px; color:#555; margin-bottom:12px; }
    .card {
      background:#fff; border-radius:10px; padding:12px; margin-bottom:10px;
      box-shadow:0 1px 3px rgba(0,0,0,0.05);
    }
    .card-title { font-size:14px; font-weight:600; margin-bottom:8px; }
    .grid-4 { display:grid; grid-template-columns:repeat(4,minmax(0,1fr)); gap:8px; }
    .grid-2 { display:grid; grid-template-columns:repeat(2,minmax(0,1fr)); gap:8px; }
    .grid-3 { display:grid; grid-template-columns:repeat(3,minmax(0,1fr)); gap:8px; }
    label { font-size:11px; display:block; margin-bottom:2px; }
    input,select,button { font-size:12px; }
    input[type="text"],input[type="number"],input[type="date"],select{
      width:100%; padding:6px 8px; border-radius:6px; border:1px solid #ccc;
    }
    .btn { padding:6px 10px; border-radius:6px; border:none; cursor:pointer; font-size:12px; white-space:nowrap; }
    .btn-primary { background:#2563eb; color:#fff; }
    .btn-gray { background:#e5e7eb; color:#111827; }
    .btn-danger { background:#dc2626; color:#fff; }
    .btn-row { display:flex; gap:6px; flex-wrap:wrap; margin-top:8px; }
    .kpi-grid { display:grid; grid-template-columns:repeat(4,minmax(0,1fr)); gap:8px; }
    .kpi {
      background:#f9fafb; border-radius:10px; padding:8px 10px;
      border:1px solid #e5e7eb;
    }
    .kpi-label { font-size:11px; color:#6b7280; }
    .kpi-value { font-size:14px; font-weight:600; margin-top:3px; }
    .kpi-sub { font-size:10px; color:#9ca3af; margin-top:2px; }
    table { width:100%; border-collapse:collapse; font-size:11px; }
    th,td { border-bottom:1px solid #e5e7eb; padding:5px 4px; text-align:left; }
    th { background:#f3f4f6; font-weight:600; }
    .right { text-align:right; }
    .badge {
      display:inline-block; padding:2px 6px; border-radius:999px;
      font-size:10px; border:1px solid #d1d5db; background:#f9fafb;
    }
    .badge-income { border-color:#16a34a; color:#166534; }
    .badge-expense { border-color:#dc2626; color:#b91c1c; }
    .badge-open { border-color:#f97316; color:#c2410c; }
    .badge-done { border-color:#4b5563; color:#111827; }
    .small { font-size:10px; color:#6b7280; margin-top:4px; }
    .log {
      width:100%; min-height:60px; font-size:11px; padding:6px 8px;
      border-radius:6px; border:1px solid #d1d5db; background:#f9fafb; white-space:pre-wrap;
    }
    canvas { width:100% !important; height:220px !important; }
    @media (max-width:1000px){
      .grid-4 { grid-template-columns:repeat(2,minmax(0,1fr)); }
      .kpi-grid { grid-template-columns:repeat(2,minmax(0,1fr)); }
      .grid-3 { grid-template-columns:1fr; }
      .grid-2 { grid-template-columns:1fr; }
    }
    @media (max-width:600px){
      .grid-4,.kpi-grid { grid-template-columns:1fr; }
    }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
<div class="app">
  <h1>WIC 재정·재무 대시보드 v1.2</h1>
  <div class="sub">거래 입력 → 집계 → 차트 시각화 한 화면 통합.</div>

  <div class="card">
    <div class="card-title">① 기간/필터</div>
    <div class="grid-4">
      <div><label>시작 날짜</label><input type="date" id="startDateFilter"></div>
      <div><label>종료 날짜</label><input type="date" id="endDateFilter"></div>
      <div><label>거래처</label><select id="clientFilter"><option value="">전체</option></select></div>
      <div><label>구분</label><select id="typeFilter"><option value="">전체</option><option value="income">수입</option><option value="expense">지출</option></select></div>
    </div>
    <div class="btn-row">
      <button class="btn btn-primary" id="applyFilterBtn">조회/필터 적용</button>
      <button class="btn btn-gray" id="clearFilterBtn">필터 초기화</button>
      <button class="btn btn-gray" id="sampleTestBtn">샘플 데이터 불러오기</button>
    </div>
  </div>

  <div class="card">
    <div class="card-title">② 핵심 지표(KPI)</div>
    <div class="kpi-grid">
      <div class="kpi"><div class="kpi-label">총 수입</div><div class="kpi-value" id="kpiTotalIncome">0 원</div></div>
      <div class="kpi"><div class="kpi-label">총 지출</div><div class="kpi-value" id="kpiTotalExpense">0 원</div></div>
      <div class="kpi"><div class="kpi-label">순이익</div><div class="kpi-value" id="kpiNetProfit">0 원</div></div>
      <div class="kpi"><div class="kpi-label">미수·미지급</div><div class="kpi-value" id="kpiOpen">0 / 0</div></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">③ 시각화 차트</div>
    <div class="grid-3">
      <div><div class="small">월별 수입/지출</div><canvas id="chartIncomeExpense"></canvas></div>
      <div><div class="small">지출 비중</div><canvas id="chartExpenseCategory"></canvas></div>
      <div><div class="small">누적 잔액</div><canvas id="chartCashFlow"></canvas></div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">④ 거래 입력/목록</div>
    <div class="grid-2">
      <div>
        <div class="grid-4">
          <div><label>날짜</label><input type="date" id="dateInput"></div>
          <div><label>거래처</label><input type="text" id="clientInput"></div>
          <div><label>구분</label><select id="typeInput"><option value="income">수입</option><option value="expense">지출</option></select></div>
          <div><label>금액(원)</label><input type="number" id="amountInput" min="0"></div>
          <div><label>정산</label><select id="statusInput"><option value="done">완료</option><option value="receivable">미수금</option><option value="payable">미지급금</option></select></div>
          <div><label>수단</label><select id="methodInput"><option value="">선택 없음</option><option value="bank">계좌</option><option value="card">카드</option><option value="cash">현금</option></select></div>
          <div><label>분류</label><select id="categoryInput"><option value="">선택 없음</option><option value="report-sale">보고서 판매</option><option value="service">서비스</option><option value="salary">급여</option><option value="rent">임대료</option><option value="tax">세금</option></select></div>
          <div><label>내역</label><input type="text" id="descInput"></div>
        </div>
        <div class="btn-row">
          <button class="btn btn-primary" id="addBtn">거래 추가</button>
          <button class="btn btn-gray" id="resetFormBtn">입력 초기화</button>
          <button class="btn btn-danger" id="clearAllBtn">모두 삭제</button>
        </div>
      </div>
      <div>
        <table>
          <thead><tr><th>날짜</th><th>거래처</th><th>구분</th><th class="right">금액</th><th>정산</th><th>분류</th><th>내역</th><th>관리</th></tr></thead>
          <tbody id="txTbody"></tbody>
        </table>
      </div>
    </div>
  </div>

  <div class="card">
    <div class="card-title">⑤ 로그/정합성</div>
    <div class="log" id="logArea"></div>
  </div>
</div>

<script>
// 모든 변수 및 함수 정의

</script>
</body>
</html>
